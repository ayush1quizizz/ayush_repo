with base as (
select distinct host_id,email
from (
select host_id,
       u.email,
--game_id,
count(distinct date_trunc( date(g.created_at),week)) as activ_wks
from clean.game g
inner join clean.user u
on g.host_id = u.user_id
where u.email not like '%quizizz.com'
and u.email not like '%wayground.com'
and u.country = 'US'
and u.occupation = 'teacher'
-- and quiz_type in ('quiz','presentation')
-- and game_type in ('tp','pres_tp')
--and players >= 2 and slide_views > 0
and g.is_classroom_game
and date(g.created_at) between '2025-08-01' and '2025-08-31'
group by 1,2
)
where activ_wks >= 4
)

select distinct
date(g.created_at) as dt,
a.host_id,
a.email,
--  game_type,
--  game_id,
--  slide_views,
--   slides
-- slides
from base a
inner join clean.game g
on a.host_id = g.host_id
and date(g.created_at) between '2025-09-01' and '2025-09-07'
and quiz_type in ('quiz','presentation')
and game_type in ('tp','pres_tp')
and players >= 2 and slide_views > 0
and  slide_views <(slides+questions)
and (slide_views*(1.0)/(slides+questions)) >= 0.5































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































